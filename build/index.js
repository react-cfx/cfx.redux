// Generated by CoffeeScript 1.10.0
var CreateStore, SI, applyMiddleware, combineReducers, createStore, mergeReduce, redux;

redux = require('redux');

createStore = redux.createStore, applyMiddleware = redux.applyMiddleware, combineReducers = redux.combineReducers;

SI = require('cfx.seamless-immutable');

CreateStore = function(reducers, pluginList) {
  if (pluginList == null) {
    pluginList = [];
  }
  return createStore(combineReducers(reducers), applyMiddleware.apply(this, pluginList));
};

mergeReduce = function(reduceMap, defaultState, options) {
  if (!defaultState) {
    throw new Error('must be provided a default state.');
  }
  return function(state, action) {
    var isImmutable, r, reduce, reduceName;
    if (state == null) {
      state = defaultState;
    }
    isImmutable = (options != null ? options.immutable : void 0) == null ? true : options.immutable === false ? false : true;
    if (isImmutable) {
      state = SI["new"](state);
    }
    r = {};
    for (reduceName in reduceMap) {
      reduce = reduceMap[reduceName];
      r[reduceName] = reduce(state[reduceName], action);
    }
    return r;
  };
};

module.exports = {
  redux: redux,
  createStore: CreateStore,
  mergeReduce: mergeReduce
};
